{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\Somayeh\\\\Downloads\\\\Video\\\\ReactMosh\\\\New folder\\\\ReactPro\\\\my-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"C:\\\\Users\\\\Somayeh\\\\Downloads\\\\Video\\\\ReactMosh\\\\New folder\\\\ReactPro\\\\my-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"C:\\\\Users\\\\Somayeh\\\\Downloads\\\\Video\\\\ReactMosh\\\\New folder\\\\ReactPro\\\\my-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport { getGlobalObject, getNumberOfUrlSegments, logger } from '@sentry/utils';\nimport hoistNonReactStatics from 'hoist-non-react-statics';\nimport React__default from 'react';\nvar _jsxFileName = \"/home/runner/work/sentry-javascript/sentry-javascript/packages/react/src/reactrouterv6.tsx\";\nvar activeTransaction;\n\nvar _useEffect;\n\nvar _useLocation;\n\nvar _useNavigationType;\n\nvar _createRoutesFromChildren;\n\nvar _matchRoutes;\n\nvar _customStartTransaction;\n\nvar _startTransactionOnLocationChange;\n\nvar global = getGlobalObject();\nvar SENTRY_TAGS = {\n  'routing.instrumentation': 'react-router-v6'\n};\n\nfunction reactRouterV6Instrumentation(useEffect, useLocation, useNavigationType, createRoutesFromChildren, matchRoutes) {\n  return function (customStartTransaction) {\n    var startTransactionOnPageLoad = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    var startTransactionOnLocationChange = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    var initPathName = global && global.location && global.location.pathname;\n\n    if (startTransactionOnPageLoad && initPathName) {\n      activeTransaction = customStartTransaction({\n        name: initPathName,\n        op: 'pageload',\n        tags: SENTRY_TAGS,\n        metadata: {\n          source: 'url'\n        }\n      });\n    }\n\n    _useEffect = useEffect;\n    _useLocation = useLocation;\n    _useNavigationType = useNavigationType;\n    _matchRoutes = matchRoutes;\n    _createRoutesFromChildren = createRoutesFromChildren;\n    _customStartTransaction = customStartTransaction;\n    _startTransactionOnLocationChange = startTransactionOnLocationChange;\n  };\n}\n\nfunction getNormalizedName(routes, location, matchRoutes) {\n  if (!routes || routes.length === 0 || !matchRoutes) {\n    return [location.pathname, 'url'];\n  }\n\n  var branches = matchRoutes(routes, location);\n  var pathBuilder = '';\n\n  if (branches) {\n    // eslint-disable-next-line @typescript-eslint/prefer-for-of\n    for (var x = 0; x < branches.length; x++) {\n      var branch = branches[x];\n      var route = branch.route;\n\n      if (route) {\n        // Early return if index route\n        if (route.index) {\n          return [branch.pathname, 'route'];\n        }\n\n        var path = route.path;\n\n        if (path) {\n          var newPath = path[0] === '/' ? path : \"/\".concat(path);\n          pathBuilder += newPath;\n\n          if (branch.pathname === location.pathname) {\n            // If the route defined on the element is something like\n            // <Route path=\"/stores/:storeId/products/:productId\" element={<div>Product</div>} />\n            // We should check against the branch.pathname for the number of / seperators\n            if (getNumberOfUrlSegments(pathBuilder) !== getNumberOfUrlSegments(branch.pathname)) {\n              return [newPath, 'route'];\n            }\n\n            return [pathBuilder, 'route'];\n          }\n        }\n      }\n    }\n  }\n\n  return [location.pathname, 'url'];\n}\n\nfunction updatePageloadTransaction(location, routes) {\n  if (activeTransaction) {\n    var _activeTransaction;\n\n    (_activeTransaction = activeTransaction).setName.apply(_activeTransaction, _toConsumableArray(getNormalizedName(routes, location, _matchRoutes)));\n  }\n}\n\nfunction handleNavigation(location, routes, navigationType, isBaseLocation) {\n  if (isBaseLocation) {\n    if (activeTransaction) {\n      activeTransaction.finish();\n    }\n\n    return;\n  }\n\n  if (_startTransactionOnLocationChange && (navigationType === 'PUSH' || navigationType === 'POP')) {\n    if (activeTransaction) {\n      activeTransaction.finish();\n    }\n\n    var _getNormalizedName = getNormalizedName(routes, location, _matchRoutes),\n        _getNormalizedName2 = _slicedToArray(_getNormalizedName, 2),\n        name = _getNormalizedName2[0],\n        source = _getNormalizedName2[1];\n\n    activeTransaction = _customStartTransaction({\n      name: name,\n      op: 'navigation',\n      tags: SENTRY_TAGS,\n      metadata: {\n        source: source\n      }\n    });\n  }\n}\n\nfunction withSentryReactRouterV6Routing(Routes) {\n  var _this = this;\n\n  if (!_useEffect || !_useLocation || !_useNavigationType || !_createRoutesFromChildren || !_matchRoutes || !_customStartTransaction) {\n    (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && logger.warn(\"reactRouterV6Instrumentation was unable to wrap Routes because of one or more missing parameters.\\n      useEffect: \".concat(_useEffect, \". useLocation: \").concat(_useLocation, \". useNavigationType: \").concat(_useNavigationType, \".\\n      createRoutesFromChildren: \").concat(_createRoutesFromChildren, \". matchRoutes: \").concat(_matchRoutes, \". customStartTransaction: \").concat(_customStartTransaction, \".\"));\n    return Routes;\n  }\n\n  var isBaseLocation = false;\n  var routes;\n\n  var SentryRoutes = function SentryRoutes(props) {\n    var location = _useLocation();\n\n    var navigationType = _useNavigationType();\n\n    _useEffect(function () {\n      // Performance concern:\n      // This is repeated when <Routes /> is rendered.\n      routes = _createRoutesFromChildren(props.children);\n      isBaseLocation = true;\n      updatePageloadTransaction(location, routes); // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [props.children]);\n\n    _useEffect(function () {\n      handleNavigation(location, routes, navigationType, isBaseLocation);\n    }, [props.children, location, navigationType, isBaseLocation]);\n\n    isBaseLocation = false; // @ts-ignore Setting more specific React Component typing for `R` generic above\n    // will break advanced type inference done by react router params\n\n    return React__default.createElement(Routes, _objectSpread({}, props, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      }\n    }));\n  };\n\n  hoistNonReactStatics(SentryRoutes, Routes); // @ts-ignore Setting more specific React Component typing for `R` generic above\n  // will break advanced type inference done by react router params\n\n  return SentryRoutes;\n}\n\nfunction wrapUseRoutes(origUseRoutes) {\n  var _this2 = this;\n\n  if (!_useEffect || !_useLocation || !_useNavigationType || !_matchRoutes || !_customStartTransaction) {\n    (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && logger.warn('reactRouterV6Instrumentation was unable to wrap `useRoutes` because of one or more missing parameters.');\n    return origUseRoutes;\n  }\n\n  var isBaseLocation = false;\n  return function (routes, location) {\n    var SentryRoutes = function SentryRoutes(props) {\n      var Routes = origUseRoutes(routes, location);\n      var locationArgObject = typeof location === 'string' ? {\n        pathname: location\n      } : location;\n\n      var locationObject = locationArgObject || _useLocation();\n\n      var navigationType = _useNavigationType();\n\n      _useEffect(function () {\n        isBaseLocation = true;\n        updatePageloadTransaction(locationObject, routes);\n      }, [props]);\n\n      _useEffect(function () {\n        handleNavigation(locationObject, routes, navigationType, isBaseLocation);\n      }, [props, locationObject, navigationType, isBaseLocation]);\n\n      isBaseLocation = false;\n      return Routes;\n    };\n\n    return React__default.createElement(SentryRoutes, {\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270\n      }\n    });\n  };\n}\n\nexport { reactRouterV6Instrumentation, withSentryReactRouterV6Routing, wrapUseRoutes };","map":null,"metadata":{},"sourceType":"module"}